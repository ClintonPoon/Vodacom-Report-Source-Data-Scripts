	SELECT 
    Convert(Date, OL.RDATE) AS [Call Date],
	Convert(Int,OL.LOGIN) as [Agent Login],
    
	CONVERT(VARCHAR, OL.ACWTIME / 3600) + ':' + 
    RIGHT('0' + CONVERT(VARCHAR, (OL.ACWTIME % 3600) / 60), 2) + ':' + 
    RIGHT('0' + CONVERT(VARCHAR, OL.ACWTIME % 60), 2) AS [Total After Call Work],

	CONVERT(VARCHAR, OL.TALKTIME / 3600) + ':' + 
    RIGHT('0' + CONVERT(VARCHAR, (OL.TALKTIME % 3600) / 60), 2) + ':' + 
    RIGHT('0' + CONVERT(VARCHAR, OL.TALKTIME % 60), 2) AS [Total Talk Time],

	CONVERT(VARCHAR, SPL.TALKTIME / 3600) + ':' + 
    RIGHT('0' + CONVERT(VARCHAR, (SPL.TALKTIME % 3600) / 60), 2) + ':' + 
    RIGHT('0' + CONVERT(VARCHAR, SPL.TALKTIME % 60), 2) AS [Total Softphone Talk Time],

	SUM(SPL.TALKTIME) AS [Total Calls Made]
FROM 
    PREP.PCO_OUTBOUNDLOG OL
	LEFT JOIN 	PREP.PCO_SOFTPHONECALLLOG SPL ON OL.ID = SPL.CONTACTID
WHERE  
    OL.SERVICEID IN (1200) 
    AND OL.RDATE >= '2024-09-03 00:00:00.000'
GROUP BY 
    Convert(Date, OL.RDATE), OL.LOGIN, OL.ACWTIME, OL.TALKTIME, SPL.TALKTIME
ORDER BY 
    OL.LOGIN, [Call Date];
