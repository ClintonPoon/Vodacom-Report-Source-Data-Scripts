SELECT 
    CONVERT(Date, CALLDATETIME) AS [Date],
    COUNT(SOURCEID) AS [Accounts Worked],
    SUM(CASE 
        WHEN CONVERT(Int, QCODE) IN (0, 1, 2, 4, 5, 6, 20, 21, 80, 81, 82, 83, 84, 85, 95, 97, 100, 103, 104, 105, 111, 113, 115, 187, 188, 213, 215) THEN 0
        WHEN CONVERT(Int, QCODE) IN (114, 132, 143, 191, 216, 101, 102, 106, 107, 108, 109, 110, 112, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 133, 134, 135, 136,
        137, 138, 139, 140, 141, 142, 144, 145, 146, 147, 183, 184, 185, 186, 189, 190, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 210, 211, 212,
        214, 217, 9, 90, 91, 92, 93, 94, 96, 98) THEN 1
        ELSE NULL 
    END) AS [Contact Indicator],
    CASE 
        WHEN COUNT(SOURCEID) > 0 THEN CAST(SUM(CASE 
            WHEN CONVERT(Int, QCODE) IN (114, 132, 143, 191, 216, 101, 102, 106, 107, 108, 109, 110, 112, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 133, 134, 135, 136,
            137, 138, 139, 140, 141, 142, 144, 145, 146, 147, 183, 184, 185, 186, 189, 190, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 210, 211, 212,
            214, 217, 9, 90, 91, 92, 93, 94, 96, 98) THEN 1
            ELSE NULL 
        END) AS FLOAT) / COUNT(SOURCEID)
        ELSE 0 
    END AS [Contact Rate]
FROM OutboundLog_Detail 
WHERE SERVICEID = 1200 
  AND CALLDATETIME >= '2024-03-01 00:00:00' 
GROUP BY CONVERT(Date, CALLDATETIME);
